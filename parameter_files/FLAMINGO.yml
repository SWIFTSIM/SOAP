# Values in this section are substituted into the other sections
# The simulation name (box size and resolution) and snapshot will be appended
# to these to get the full name of the input/output files/directories
Parameters:
  sim_dir: /cosma8/data/dp004/flamingo/Runs
  output_dir: /cosma8/data/dp004/dc-mcgi1/flamingo/Runs
  scratch_dir: /snap8/scratch/dp004/dc-mcgi1/flamingo/Runs

# Location of the Swift snapshots:
Snapshots:
  # Use {snap_nr:04d} for the snapshot number and {file_nr} for the file number.
  filename: "{sim_dir}/{sim_name}/snapshots/flamingo_{snap_nr:04d}/flamingo_{snap_nr:04d}.{file_nr}.hdf5"
  # Pass the location of snapshots with FOF IDs if the FOF has been re-run
  # If fof_filename is not passed the FOF IDs in the snapshot will be used
  fof_filename: "/cosma8/data/dp004/jlvc76/FLAMINGO/FOF/{sim_name}/fof_snapshot/flamingo_{snap_nr:04d}/flamingo_{snap_nr:04d}.{file_nr}.hdf5"

# Which halo finder we're using, and base name for halo finder output files
HaloFinder:
  #type: VR
  #filename: "{sim_dir}/{sim_name}/VR/catalogue_{snap_nr:04d}/vr_catalogue_{snap_nr:04d}"
  type: HBTplus
  filename: "{sim_dir}/{sim_name}/HBT/{snap_nr:03d}/SubSnap_{snap_nr:03d}"
  fof_filename: "/cosma8/data/dp004/jlvc76/FLAMINGO/FOF/{sim_name}/fof_catalog/fof_output_{snap_nr:04d}/fof_output_{snap_nr:04d}.{file_nr}.hdf5"
  #type: Subfind
  #filename: "{sim_dir}/{sim_name}/snapdir_{snap_nr:03d}/snapshot_{snap_nr:03d}"
  #type: Rockstar
  #filename: "{sim_dir}/{sim_name}/Rockstar/snapshot_{snap_nr:04d}/halos_{snap_nr:04d}"

GroupMembership:
  # Where to write the group membership files
  filename: "{sim_dir}/{sim_name}/SOAP-HBT/membership_{snap_nr:04d}/membership_{snap_nr:04d}.{file_nr}.hdf5"

ExtraInput:
  xray_filename: "{output_dir}/{sim_name}/recalculated_xray/xray_{snap_nr:04d}/xray_{snap_nr:04d}.{file_nr}.hdf5"

HaloProperties:
  # Where to write the halo properties file
  filename: "{output_dir}/{sim_name}/SOAP_uncompressed/{halo_finder}/halo_properties_{snap_nr:04d}.hdf5"
  # Where to write temporary chunk output
  chunk_dir: "{scratch_dir}/{sim_name}/SOAP-tmp/{halo_finder}/"

ApertureProperties:
  properties:
    AngularMomentumBaryons: baryon
    AngularMomentumDarkMatter: dm
    AngularMomentumGas: gas
    AngularMomentumStars: star
    BlackHolesDynamicalMass: basic
    BlackHolesLastEventScalefactor: general
    BlackHolesSubgridMass: basic
    CentreOfMass: basic
    CentreOfMassVelocity: basic
    DarkMatterMass: basic
    DiscToTotalGasMassFraction: gas
    DiscToTotalStellarMassFraction: star
    GasMass: basic
    GasMassFractionInIron: general
    GasMassFractionInMetals: basic
    GasMassFractionInOxygen: general
    GasTemperature: general
    GasTemperatureWithoutRecentAGNHeating: general
    HalfMassRadiusBaryons: baryon
    HalfMassRadiusDarkMatter: dm
    HalfMassRadiusGas: gas
    HalfMassRadiusStars: basic
    KappaCorotBaryons: baryon
    KappaCorotGas: gas
    KappaCorotStars: star
    KineticEnergyGas: gas
    KineticEnergyStars: star
    LuminosityWeightedMeanStellarAge: star
    MassWeightedMeanStellarAge: star
    MostMassiveBlackHoleAccretionRate: general
    MostMassiveBlackHoleID: basic
    MostMassiveBlackHoleLastEventScalefactor: general
    MostMassiveBlackHoleMass: basic
    MostMassiveBlackHolePosition: general
    MostMassiveBlackHoleVelocity: general
    NumberOfBlackHoleParticles: basic
    NumberOfDarkMatterParticles: basic
    NumberOfGasParticles: basic
    NumberOfStarParticles: basic
    StarFormationRate: basic
    StarFormingGasMass: general
    StarFormingGasMassFractionInIron: general
    StarFormingGasMassFractionInMetals: basic
    StarFormingGasMassFractionInOxygen: general
    StellarCentreOfMass: star
    StellarCentreOfMassVelocity: star
    StellarInitialMass: star
    StellarLuminosity: star
    StellarMass: basic
    StellarMassFractionInIron: star
    StellarMassFractionInMetals: basic
    StellarMassFractionInOxygen: star
    TotalMass: basic
  variations:
    exclusive_1000_kpc:
      inclusive: false
      radius_in_kpc: 1000.0
      filter: general
    exclusive_100_kpc:
      inclusive: false
      radius_in_kpc: 100.0
    exclusive_10_kpc:
      inclusive: false
      radius_in_kpc: 10.0
    exclusive_3000kpc:
      inclusive: false
      radius_in_kpc: 3000.0
      filter: general
    exclusive_300kpc:
      inclusive: false
      radius_in_kpc: 300.0
    exclusive_30_kpc:
      inclusive: false
      radius_in_kpc: 30.0
    exclusive_500_kpc:
      inclusive: false
      radius_in_kpc: 500.0
      filter: general
    exclusive_50_kpc:
      inclusive: false
      radius_in_kpc: 50.0
    inclusive_1000_kpc:
      inclusive: true
      radius_in_kpc: 1000.0
      filter: general
    inclusive_100_kpc:
      inclusive: true
      radius_in_kpc: 100.0
    inclusive_10_kpc:
      inclusive: true
      radius_in_kpc: 10.0
    inclusive_3000kpc:
      inclusive: true
      radius_in_kpc: 3000.0
      filter: general
    inclusive_300kpc:
      inclusive: true
      radius_in_kpc: 300.0
    inclusive_30_kpc:
      inclusive: true
      radius_in_kpc: 30.0
    inclusive_500_kpc:
      inclusive: true
      radius_in_kpc: 500.0
      filter: general
    inclusive_50_kpc:
      inclusive: true
      radius_in_kpc: 50.0
ProjectedApertureProperties:
  properties:
    BlackHolesDynamicalMass: basic
    BlackHolesLastEventScalefactor: general
    BlackHolesSubgridMass: basic
    CentreOfMass: basic
    CentreOfMassVelocity: basic
    DarkMatterMass: basic
    DarkMatterProjectedVelocityDispersion: dm
    GasMass: basic
    GasProjectedVelocityDispersion: gas
    HalfMassRadiusBaryons: baryon
    HalfMassRadiusDarkMatter: dm
    HalfMassRadiusGas: gas
    HalfMassRadiusStars: basic
    MostMassiveBlackHoleID: basic
    MostMassiveBlackHoleAccretionRate: general
    MostMassiveBlackHoleLastEventScalefactor: general
    MostMassiveBlackHoleMass: basic
    MostMassiveBlackHolePosition: general
    MostMassiveBlackHoleVelocity: general
    NumberOfBlackHoleParticles: basic
    NumberOfDarkMatterParticles: basic
    NumberOfGasParticles: basic
    NumberOfStarParticles: basic
    ProjectedTotalInertiaTensorNoniterative: general
    ProjectedTotalInertiaTensorReducedNoniterative: general
    ProjectedGasInertiaTensorNoniterative: gas
    ProjectedGasInertiaTensorReducedNoniterative: gas
    ProjectedStellarInertiaTensorNoniterative: star
    ProjectedStellarInertiaTensorReducedNoniterative: star
    StarFormationRate: basic
    StellarInitialMass: star
    StellarLuminosity: star
    StellarMass: basic
    StellarProjectedVelocityDispersion: star
    TotalMass: basic
  variations:
    100_kpc:
      radius_in_kpc: 100.0
      filter: general
    10_kpc:
      radius_in_kpc: 10.0
      filter: general
    30_kpc:
      radius_in_kpc: 30.0
      filter: general
    50_kpc:
      radius_in_kpc: 50.0
      filter: general
SOProperties:
  properties:
    AngularMomentumBaryons: baryon
    AngularMomentumDarkMatter: dm
    AngularMomentumGas: gas
    AngularMomentumStars: star
    BlackHolesDynamicalMass: basic
    BlackHolesLastEventScalefactor: general
    BlackHolesSubgridMass: basic
    CentreOfMass: basic
    CentreOfMassVelocity: basic
    ComptonY: general
    ComptonYWithoutRecentAGNHeating: general
    Concentration: basic
    ConcentrationUnsoftened: basic
    DarkMatterMass: basic
    DarkMatterConcentration: basic
    DarkMatterConcentrationUnsoftened: basic
    DiscToTotalGasMassFraction: gas
    DiscToTotalStellarMassFraction: star
    DopplerB: general
    GasCentreOfMass: gas
    GasCentreOfMassVelocity: gas
    GasComptonYTemperature: general
    GasComptonYTemperatureWithoutRecentAGNHeating: general
    GasComptonYTemperatureCoreExcision: general
    GasComptonYTemperatureWithoutRecentAGNHeatingCoreExcision: general
    GasMass: basic
    GasMassFractionInIron: general
    GasMassFractionInMetals: basic
    GasMassFractionInOxygen: general
    GasTemperature: general
    GasTemperatureCoreExcision: general
    GasTemperatureWithoutCoolGas: general
    GasTemperatureWithoutCoolGasAndRecentAGNHeating: general
    GasTemperatureWithoutCoolGasAndRecentAGNHeatingCoreExcision: general
    GasTemperatureWithoutCoolGasCoreExcision: general
    GasTemperatureWithoutRecentAGNHeating: general
    GasTemperatureWithoutRecentAGNHeatingCoreExcision: general
    HotGasMass: general
    KineticEnergyGas: gas
    KineticEnergyStars: star
    MassFractionSatellites: general
    MassFractionExternal: general
    MostMassiveBlackHoleAccretionRate: general
    MostMassiveBlackHoleID: basic
    MostMassiveBlackHoleLastEventScalefactor: general
    MostMassiveBlackHoleMass: basic
    MostMassiveBlackHolePosition: general
    MostMassiveBlackHoleVelocity: general
    NoiseSuppressedNeutrinoMass: basic
    NumberOfBlackHoleParticles: basic
    NumberOfDarkMatterParticles: basic
    NumberOfGasParticles: basic
    NumberOfNeutrinoParticles: basic
    NumberOfStarParticles: basic
    RawNeutrinoMass: basic
    SORadius: basic
    SpectroscopicLikeTemperature: general
    SpectroscopicLikeTemperatureCoreExcision: general
    SpectroscopicLikeTemperatureWithoutRecentAGNHeating: general
    SpectroscopicLikeTemperatureWithoutRecentAGNHeatingCoreExcision: general
    SpinParameter: general
    StarFormationRate: basic
    StarFormingGasMassFractionInMetals: basic
    StellarCentreOfMass: star
    StellarCentreOfMassVelocity: star
    StellarInitialMass: star
    StellarLuminosity: star
    StellarMass: basic
    StellarMassFractionInIron: star
    StellarMassFractionInMetals: basic
    StellarMassFractionInOxygen: star
    TotalInertiaTensorNoniterative: general
    GasInertiaTensorNoniterative: gas
    DarkMatterInertiaTensorNoniterative: dm
    StellarInertiaTensorNoniterative: star
    TotalInertiaTensorReducedNoniterative: general
    GasInertiaTensorReducedNoniterative: gas
    DarkMatterInertiaTensorReducedNoniterative: dm
    StellarInertiaTensorReducedNoniterative: star
    MaximumCircularVelocity: basic
    MaximumCircularVelocityRadius: basic
    ThermalEnergyGas: general
    TotalMass: basic
    XRayLuminosity: general
    XRayLuminosityCoreExcision: general
    XRayLuminosityWithoutRecentAGNHeating: general
    XRayLuminosityWithoutRecentAGNHeatingCoreExcision: general
    XRayLuminosityInRestframe: general
    XRayLuminosityInRestframeCoreExcision: general
    XRayLuminosityInRestframeWithoutRecentAGNHeating: general
    XRayLuminosityInRestframeWithoutRecentAGNHeatingCoreExcision: general
    XRayPhotonLuminosity: general
    XRayPhotonLuminosityCoreExcision: general
    XRayPhotonLuminosityWithoutRecentAGNHeating: general
    XRayPhotonLuminosityWithoutRecentAGNHeatingCoreExcision: general
    XRayPhotonLuminosityInRestframe: general
    XRayPhotonLuminosityInRestframeCoreExcision: general
    XRayPhotonLuminosityInRestframeWithoutRecentAGNHeating: general
    XRayPhotonLuminosityInRestframeWithoutRecentAGNHeatingCoreExcision: general
  variations:
    200_crit:
      type: crit
      value: 200.0
    50_crit:
      type: crit
      value: 50.0
      filter: general
    100_crit:
      type: crit
      value: 100.0
      filter: general
    200_mean:
      type: mean
      value: 200.0
    500_crit:
      type: crit
      value: 500.0
      core_excision_fraction: 0.15
    5xR500_crit:
      type: crit
      value: 500.0
      radius_multiple: 5.0 
      filter: general
    1000_crit:
      type: crit
      value: 1000.0
      filter: general
    2500_crit:
      type: crit
      value: 2500.0
      filter: general
    BN98:
      type: BN98
      value: 0.0
      filter: general
SubhaloProperties:
  properties:
    AngularMomentumBaryons: baryon
    AngularMomentumDarkMatter: dm
    AngularMomentumGas: gas
    AngularMomentumStars: star
    BlackHolesDynamicalMass: basic
    BlackHolesLastEventScalefactor: general
    BlackHolesSubgridMass: basic
    CentreOfMass: basic
    CentreOfMassVelocity: basic
    DarkMatterMass: basic
    DarkMatterVelocityDispersionMatrix: dm
    DiscToTotalGasMassFraction: gas
    DiscToTotalStellarMassFraction: star
    GasMass: basic
    GasMassFractionInMetals: basic
    GasTemperature: general
    GasTemperatureWithoutCoolGas: general
    GasTemperatureWithoutCoolGasAndRecentAGNHeating: general
    GasTemperatureWithoutRecentAGNHeating: general
    GasVelocityDispersionMatrix: gas
    HalfMassRadiusBaryons: baryon
    HalfMassRadiusDarkMatter: dm
    HalfMassRadiusGas: gas
    HalfMassRadiusStars: basic
    HalfMassRadiusTotal: general
    EncloseRadius: basic
    KappaCorotBaryons: baryon
    KappaCorotGas: gas
    KappaCorotStars: star
    LuminosityWeightedMeanStellarAge: star
    MassWeightedMeanStellarAge: star
    MaximumCircularVelocity: basic
    MaximumCircularVelocityRadiusUnsoftened: basic
    MaximumCircularVelocityUnsoftened: basic
    MaximumDarkMatterCircularVelocity: dm
    MaximumDarkMatterCircularVelocityRadius: dm
    MostMassiveBlackHoleAccretionRate: general
    MostMassiveBlackHoleID: basic
    MostMassiveBlackHoleLastEventScalefactor: general
    MostMassiveBlackHoleMass: basic
    MostMassiveBlackHolePosition: general
    MostMassiveBlackHoleVelocity: general
    NumberOfBlackHoleParticles: basic
    NumberOfDarkMatterParticles: basic
    NumberOfGasParticles: basic
    NumberOfStarParticles: basic
    TotalInertiaTensor: general
    GasInertiaTensor: gas
    DarkMatterInertiaTensor: dm
    StellarInertiaTensor: star
    TotalInertiaTensorReduced: general
    GasInertiaTensorReduced: gas
    DarkMatterInertiaTensorReduced: dm
    StellarInertiaTensorReduced: star
    TotalInertiaTensorNoniterative: general
    GasInertiaTensorNoniterative: gas
    DarkMatterInertiaTensorNoniterative: dm
    StellarInertiaTensorNoniterative: star
    TotalInertiaTensorReducedNoniterative: general
    GasInertiaTensorReducedNoniterative: gas
    DarkMatterInertiaTensorReducedNoniterative: dm
    StellarInertiaTensorReducedNoniterative: star
    SpinParameter: general
    StarFormationRate: basic
    StarFormingGasMass: general
    StarFormingGasMassFractionInMetals: basic
    StellarInitialMass: star
    StellarLuminosity: star
    StellarMass: basic
    StellarMassFractionInMetals: basic
    StellarVelocityDispersionMatrix: star
    TotalMass: basic
aliases:
  PartType0/ElementMassFractions: PartType0/SmoothedElementMassFractions
  PartType4/ElementMassFractions: PartType4/SmoothedElementMassFractions
filters:
  general:
    limit: 100
    properties:
      - BoundSubhalo/NumberOfGasParticles
      - BoundSubhalo/NumberOfDarkMatterParticles
      - BoundSubhalo/NumberOfStarParticles
      - BoundSubhalo/NumberOfBlackHoleParticles
    combine_properties: sum
  baryon:
    limit: 100
    properties:
      - BoundSubhalo/NumberOfGasParticles
      - BoundSubhalo/NumberOfStarParticles
    combine_properties: sum
  dm:
    limit: 100
    properties:
      - BoundSubhalo/NumberOfDarkMatterParticles
  gas:
    limit: 100
    properties:
      - BoundSubhalo/NumberOfGasParticles
  star:
    limit: 100
    properties:
      - BoundSubhalo/NumberOfStarParticles
defined_constants:
  O_H_sun: 4.9e-4
  Fe_H_sun: 2.82e-5
calculations:
  min_read_radius_cmpc: 5
  calculate_missing_properties: false
  reduced_snapshots:
    min_halo_mass: 1e13
    halo_bin_size_dex: .05
    halos_per_bin: 200
  recently_heated_gas_filter:
    delta_time_myr: 15
    use_AGN_delta_T: true
